// Copyright 2025 The Chromium Authors
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

syntax = "proto3";

package turboci.graph.orchestrator.v1;

import "turboci/graph/ids/v1/identifier.proto";

option go_package = "go.chromium.org/turboci/proto/go/graph/orchestrator/v1;orchestratorpb";
option java_multiple_files = true;

// Represents an actor which owns/created/edited a node.
message Actor {
  // Placeholder type for when the Orchestrator itself makes this edit.
  message Orchestrator {}

  // Placeholder type for when the creator of the Workplan makes this edit.
  message WorkplanCreator {}

  // External indicates that the edit came from some Actor using an External
  // permission variant (no write token used).
  message External {
    // TBD: Add a field here for the external account identity. Note that
    // doing this properly will require nuance to distinguish between e.g.
    // 1st party service accounts, 1st party accounts and 3rd party accounts.
    //
    // This requires extra privacy and permission apparatus, so for now the
    // external account information is not maintained (but, also, we don't
    // expect to hand out external writer permissions widely).
  }

  // The kind of editor which edited this node.
  oneof kind {
    // The StageAttempt which generated this Edit.
    //
    // This is the most common case.
    ids.v1.StageAttempt stage_attempt = 1;

    // The Orchestrator generated this Edit.
    Orchestrator orchestrator = 2;

    // The Creator of the Workplan generated this Edit.
    WorkplanCreator workplan_creator = 3;

    // An account not represented by one of the other Actor kinds.
    External external = 4;
  }
}
